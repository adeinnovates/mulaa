{"remainingRequest":"/Users/samsonaligba/Sites/mulaa.co/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/samsonaligba/Sites/mulaa.co/src/components/Product.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/samsonaligba/Sites/mulaa.co/src/components/Product.vue","mtime":1575116408476},{"path":"/Users/samsonaligba/Sites/mulaa.co/node_modules/vuetify-loader/lib/loader.js","mtime":1564062719000},{"path":"/Users/samsonaligba/Sites/mulaa.co/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/samsonaligba/Sites/mulaa.co/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapState, mapGetters } from 'vuex'\nimport axios from 'axios'\n//import Rave from 'vue-ravepayment';\n//import paystack from 'vue-paystack';\nimport Callback from '@/components/Callback'\nconst mulaa_key = 'pk_live_d2ea70959fc4383baf5844b947709e17db19b1d0'\nexport default {\n    props: ['name','theproducts'],\n     components: {\n        //paystack\n        Callback,\n        // Rave\n    },\n data(){\n        return {\n          //raveKey: \"FLWPUBK-xxxxxxxxxxxxxxxxxx-X\",\n          overlay:true,\n          checkOption: false,\n          optionColor: 'green',\n          priceOption: 'black',\n          loader: null,\n        btnloading: false,\n          clicked: [],\n            hide:false,\nprogress: 10,\ndialog: false,\npageurl: 'https://shop.mulaa.co'+this.$route.path,\n           infoBar: false,\n            /*title: this.theProduct.title,\n            hidethis: this.theProduct.hidden, \n            datePosted: this.theProduct.date_posted,\n            delivery:this.theProduct.delivery_locations,\n            description:this.theProduct.description,\n            discountPrice:this.theProduct.discount_price,\n            image: this.theProduct.image,\n            price: this.theProduct.price,\n            discounted: this.theProduct.show_discount,*/\n            sheet: false,\n            title:'',\n            title2: '',\n            delivery:'',\n            description:'',\n            discountPrice:'',\n            productOptions: '',\n            stock:'',\n            Options: [\n           \n            ],\n            image: '',\n            price: '',\n            discounted: '',\n            buyerName: '',\n            buyerEmail: '',\n            buyerPhone: '',\n            buyerAddress:'',\n            newAmount: null,\n            delivery:'',\n        infoMsg: '', \n        color: '',\n        paymentStatus: [],\n       emailRules: [\n        v => !!v || 'E-mail is required',\n        v => /.+@.+/.test(v) || 'E-mail must be valid'\n      ]\n        }\n    },\n\n    computed: {\n      ...mapState({\n      registerMsg:'registerMsg',\n      loading:'loading',\n      userKey:'userKey',\n      theProduct:'theProduct',\n      userDetails:'userDetails'\n      }),\n      loading: {\n      get() {\n        return this.$store.state.loading;\n      },\n      set(value) {\n        this.$store.commit('loading', value);\n      }\n    },\n    reference(){\n        let text = \"\";\n        let possible = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n \n        for( let i=0; i < 10; i++ )\n          text += possible.charAt(Math.floor(Math.random() * possible.length));\n \n        return text;\n      },\n      amount(){\n          if(this.discounted == false || this.discounted == undefined){\n              let amount = this.price\n              //console.log(this.discounted)\n             // console.log('amount: '+ amount)\n\n              return amount\n          }else {\n              //this.hide = true\n              console.log(this.discounted)\n              let amount = this.discountPrice\n              return amount\n          }\n      },\n       disabled() {\n       if (this.buyerName.length < 1 || this.buyerEmail == ' '){\n           this.infoBar = true\n           this.infoMsg = 'fill in your details to complete purchase'\n           this.color='red'\n         return true\n       }\n       return false\n        //return this.imageFile.length < 1; // or === 0   \n    },\n   kOptions: {\n      get: function(){\n        if(this.productOptions){\n          if(JSON.parse(this.productOptions).length > 1){\n            this.checkOption = true\n          }\n          //console.log(JSON.parse(this.productOptions).length)\n          \n          return JSON.parse(this.productOptions);\n        }\n        return  //this.productOptions//JSON.parse(this.productOptions);\n      }\n    },\n    mySrc: {\n    get: function() {\n      //concat using template literal\n      return `https://shop.mulaa.co/api/product/${this.title2}`\n    }\n  }\n\n    },\n     created() {\n        this.fetchData()\n        this.updateData()\n        this.toUrlString(this.title)\n       \n/*\n        const script = document.createElement('script')\n        script.src = 'https://api.ravepay.co/flwv3-pug/getpaidx/api/flwpbf-inline.js'\n        document.getElementsByTagName('head')[0].appendChild(script)\n        */\n\n//console.log(this.theProduct)\n    },\n    methods: {\n      addOption(index,name,price) {\n        console.log(name)\n        this.loader = 'btnloading'\n        //let nprice = parseInt(price)\n        this.newAmount = parseInt(this.newAmount) + parseInt(price)\n        this.price = parseInt(this.price) + parseInt(price)\nthis.clicked.push(index)\n            this.Options.push({ name: name, price: price });\n        },\n      toUrlString(productname){\nlet productName = productname\nproductName = productName.replace(/\\s+/g, '-').toLowerCase();\nthis.title2 = productName\n      },\n        salesRecord(response){\n            //console.log(\"sales: \"+response)\n\n//axios.post(`//dev.mulaa.africa/admin/wp-json/jwt-auth/v1/token`, {\n  axios.post(`https://shop.mulaa.co/api/wp-json/jwt-auth/v1/token`, {\n    username: 'system',\n    password: 'letmein2020()'\n  }\n).then(resp => {\n           //console.log(resp.data.token)\n           const options = {\n  headers: {'Authorization': 'Bearer '+resp.data.token}\n}\nconst salesData = {\n                title: this.title,\n                content: this.theProduct.title,\n                fields : {\n                 ref_id: response.reference,\n            amount: this.newAmount,\n            payment_mode: \"online\",\n            fullname: this.buyerName,\n            status: response.status,\n            message: response.message,\n            date: this.date,\n            product_id: this.$route.params.id,\n            product: this.title,\n            customer_email: this.buyerEmail,\n            customer_phone: this.buyerPhone,\n            location: this.buyerAddress,\n            transaction: response.transaction,\n            merchant: this.$route.params.name,\n            delivery: this.buyerAddress,\n            merchant_email: this.userDetails.email,\n            others: this.Options\n                },\n                 status: \"publish\"\n            }\n\n           //axios.post(`http://dev.mulaa.africa/admin/wp-json/wp/v2/sale`, \n           axios.post(`https://shop.mulaa.co/api/wp-json/wp/v2/sale`,\n           salesData, options\n).then(resp => {\n            //console.log(resp.data)\n            this.loading = false\n            })\n            //resolve(resp)\n          })\n          .catch(err => {\n              console.log(err)\n              \n          })\n        },\n        updateData(){\n          //console.log(this.theProduct.price)\n            if(this.theproducts === undefined){\n                //console.log('refreshed')\n                this.title = this.theProduct.title\n            this.hidethis = this.theProduct.hidden\n            this.datePosted = this.theProduct.date_posted\n            this.delivery = this.theProduct.delivery_locations\n            this.description = this.theProduct.description\n            this.discountPrice = this.theProduct.discount_price\n            this.image = this.theProduct.image\n            this.price = this.theProduct.price\n            this.discounted = this.theProduct.show_discount\n            this.newAmount = this.amount\n            this.stock = this.theProduct.stock\n            this.productOptions = this.theProduct.product_options\n            console.log(this.theProduct.productOptions)\n             //console.log('refreshed amount '+this.newAmount) \n            }else{\n                //console.log('valid click')\n                //console.log(this.theproducts)\n                this.title = this.theproducts.title\n            this.hidethis = this.theproducts.hidden\n            this.datePosted = this.theproducts.date_posted\n            this.delivery = this.theproducts.delivery_locations\n            this.description = this.theproducts.description//this.theProduct.description\n            this.discountPrice = this.theproducts.discount_price\n            this.image = this.theproducts.image\n            this.price = this.theproducts.price\n            this.discounted = this.theproducts.show_discount\n            this.productOptions = this.theproducts.productOptions\n            this.newAmount = this.amount\n            this.stock = this.theproducts.stock\n            //console.log(this.newAmount)\n            }\n        },\n        amount2(){\n          if(this.discounted == true){\n              let amount = this.discountPrice * 100\n              \n              console.log('discount price: '+ amount)\n              return amount\n          }else {\n              let amount = this.price * 100\n              console.log('full price: '+this.price)\n              return amount\n          }\n      },\n      resetForm () {\n        this.$refs.buyForm.reset()\n      },\n    reset(file, name) {\n      console.log(\"File --> \", file);\n      console.log(\"FileName -->\", name);\n    },\n    fileChange(file, name) {\n      console.log(\"File --> \", file);\n      console.log(\"FileName -->\", name);\n    },\n    onErr(err, file) {\n      console.log(\"​onErr -> file\", file);\n      console.log(\"​onErr -> err\", err);\n    },\n     onSuc(res, file) {\n      console.log(\"​onSuc -> file\", file);\n      console.log(\"​onSuc -> res\", res);\n      this.imgUrl = res.url\n      this.uploadMsg = res.message\n      \n    },\n    exceedHandler(file) {\n      console.warn(\"onExceed -> file\", file);\n    },\n    fetchData(){\n        this.$store.dispatch('loadProduct', this.$route.params.id)\n        this.$store.dispatch('loadUserDetails', this.name)\n        //console.log(\"product id: \"+this.$route.params.id)\n    },\n  callback: function(response){\n       // console.log(response)\n       \n       this.paymentStatus = response\n       this.salesRecord(response)\n            var oLuanchBtn = document.getElementById('popupBtn');\n            oLuanchBtn.style.visibility = 'hidden';\n            oLuanchBtn.click();\n            //this.resetForm()\n            \n            console.log('payment: '+this.paymentStatus.reference)\n      },\n      close: function(){\n          console.log(\"Payment closed\")\n      },\n      payWithPaystack() {\n        if(this.userDetails.subaccount_code !='' || this.userDetails.subaccount_code !=null)\n        {\n          //console.log('use subaccount '+ mulaa_key)\n          //\n          const paystackOptions = {\n                    key: mulaa_key,\n                    email: this.buyerEmail,\n                    amount: Number(this.amount2()),\n                    subaccount: this.userDetails.subaccount_code,\n                    transaction_charge: 0,\n                    bearer: 'subaccount',\n                    ref: this.reference,\n                    callback: (response) => { //message: \"Approved\" reference: \"rVZKHQSn6b\" status: \"success\" trans: \"256223954\" transaction: \"256223954\" trxref: \"rVZKHQSn6b\"\n                        this.callback(response)\n                        //this.showPopup(response)\n                    },\n                    onClose: () => {\n                        this.close()\n                        this.$router.go(-1)\n                    }\n                }\n            //console.log(paystackOptions)\n          const handler = window.PaystackPop.setup(paystackOptions)\n          handler.openIframe()\n          //\n        }else{\n const paystackOptions = {\n                    key: this.userDetails.payment_key,\n                    email: this.buyerEmail,\n                    amount: Number(this.amount2()),\n                    ref: this.reference,\n                    callback: (response) => { //message: \"Approved\" reference: \"rVZKHQSn6b\" status: \"success\" trans: \"256223954\" transaction: \"256223954\" trxref: \"rVZKHQSn6b\"\n                        this.callback(response)\n                        //this.showPopup(response)\n                    },\n                    onClose: () => {\n                        this.close()\n                        this.$router.go(-1)\n                    }\n                }\n            //console.log(paystackOptions)\n          const handler = window.PaystackPop.setup(paystackOptions)\n          handler.openIframe()\n        }\n         \n      }\n  },\n  mounted() {\n     //console.log(this.userDetails.subaccount_code)\nthis.loading = false\n    let paystackScript = document.createElement('script')\n    paystackScript.setAttribute('src', 'https://js.paystack.co/v1/inline.js')\n    document.head.appendChild(paystackScript)\n\n//let phpUrl = document.createElement('iframe')\n//phpUrl.setAttribute('src', 'https://shop.mulaa.co/api/product/the-uju-set')\n//document.body.appendChild(phpUrl)\n\n    var oLuanchBtn = document.getElementById('popupBtn');\n            oLuanchBtn.style.display = 'none';\n         // this.showPopup()   \n          //console.log('userdetails: '+JSON.stringify(this.userDetails))  \n  },\n  watch: {\n      loader () {\n        const l = this.loader\n        this[l] = !this[l]\n\n        setTimeout(() => (this[l] = false), 3000)\n\n        this.loader = null\n      },\n    }\n}\n",{"version":3,"sources":["Product.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA","file":"Product.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <div class=\"single-product page\">\n        <v-card\n            max-width=\"454\"\n            class=\"mx-auto\"\n            >\n           <v-progress-linear\n                            :active=loading\n                            indeterminate\n                            color=\"green\"\n                            ></v-progress-linear> \n<v-form\n      ref=\"buyForm\"\n      class=\"pa-0\"\n    >\n           \n <v-snackbar v-model=infoBar bottom right :color=\"color\" :value=infoMsg>\n  <span>{{infoMsg}}</span>\n  <v-btn text overline color=\"white\" @click=\"infoBar = false\">close</v-btn>\n</v-snackbar>\n<v-row align=\"center\" justify=\"center\">\n                    <v-img\n                    :src=\"image\"\n                    lazy-src=\"https://picsum.photos/id/11/10/6\"\n                    aspect-ratio=\"1\"\n                    class=\"grey lighten-2 mb-3\"\n                    max-width=\"500\"\n                    max-height=\"300\"\n                    @click=\"overlay = !overlay\"\n                    >\n\n<v-row class=\"fill-height d-flex wrap justify-space-between\" style=\"flex-direction: column;height:100%\">\n<v-card-title class=\"ml-5\">\n\n            <!-- <social-sharing :url=pageurl\n                :title=title\n                :description=description\n                :quote=description\n                hashtags=\"mulaa,buy,shop,share,deal\"\n                inline-template>\n                 <div class=\"caption grey--text text--darken-2 grey lighten-5 px-3\" elevation=5 style=\"border-radius:10px\">\n              \n                    <network network=\"facebook\" class=\"px-3\">\n                    <i class=\"fa fa-facebook\"></i> \n                    </network>\n                    <network network=\"sms\" class=\"px-3\">\n                    <i class=\"fa fa-commenting-o\"></i>\n                    </network>\n                    <network network=\"twitter\" class=\"px-3\">\n                    <i class=\"fa fa-twitter\"></i>\n                    </network>\n                    <network network=\"whatsapp\" class=\"px-3\">\n                    <i class=\"fa fa-whatsapp\"></i>\n                    </network>\n                  \n                     </div>\n                </social-sharing>-->\n</v-card-title>\n<v-card-text class=\"white--text ml-5\">\n<div class=\"headline font-weight-light pt-12 otto\">{{this.title}}</div>\n</v-card-text>\n</v-row>\n\n                    </v-img>\n\n<v-overlay \n:value=\"overlay\"\n:opacity=\"0.9\"\n>\n<v-layout row wrap mx-auto>\n  <v-flex xs10 sm9 md9 lg9>\n<div class=\"headline font-weight-light\">{{this.title}}</div>\n  </v-flex>\n <v-flex xs2 sm3 md3 lg3 text-right>\n    <v-btn\nicon\n@click=\"overlay = false\"\n>\n<v-icon right>mdi-close</v-icon>\n</v-btn>\n  </v-flex>\n</v-layout>\n\n\n<v-img\n:src=\"image\"\nlazy-src=\"https://picsum.photos/id/11/10/6\"\nheight='300'\nwidth=\"300\"\nclass=\"grey lighten-2 mb-3\"\nstyle=\"border-radius:10px;\"\n@click=\"overlay = !overlay\"\n>\n<div v-show=\"this.stock == 0\" class=\"outofstock\">\n              <v-chip\n              class=\"ma-2 point text-uppercase font-weight-black\"\n              color=\"red\"\n              label\n              small\n              text-color=\"white\"\n              >\n              <v-icon small left>mdi-cart-off</v-icon>\n              sold out\n              </v-chip>\n              </div><!-- hidden / out of stock-->\n</v-img>\n\n<v-layout row wrap mx-auto>\n  <v-flex xs3 sm3 md4 lg4>\n        <v-btn text color=\"#23d2aa\" \n        class=\"caption\"\n        @click=\"overlay = false\"\n        v-show=\"this.stock > 0\"\n        >\n        <v-icon small left>mdi-cart</v-icon>\n        Buy Now\n        </v-btn>\n  </v-flex>\n <v-flex xs9 sm9 md8 lg8 text-right>\n          <social-sharing :url=pageurl\n          :title=title\n          :description=description\n          :quote=description\n          hashtags=\"mulaa,buy,shop,share,deal\"\n          inline-template>\n          <div class=\"caption grey--text text--darken-2 px-3 mt-1\">\n\n          <network network=\"facebook\" class=\"px-3 blue--text text--darken-2\">\n          <i class=\"fa fa-facebook fa-lg\"></i> \n          </network>\n          <network network=\"sms\" class=\"px-3 blue--text\">\n          <i class=\"fa fa-commenting-o fa-lg\"></i>\n          </network>\n          <network network=\"twitter\" class=\"px-3 blue--text text--lighten-2\">\n          <i class=\"fa fa-twitter fa-lg\"></i>\n          </network>\n          <network network=\"whatsapp\" class=\"px-3 green--text\">\n          <i class=\"fa fa-whatsapp fa-lg\"></i>\n          </network>\n\n          </div>\n          </social-sharing>\n  </v-flex>\n</v-layout>\n\n</v-overlay>\n</v-row>\n\n               <!-- <v-card-title>-->\n                    <!--<span class=\"headline grey--text text--darken-2 mb-1 px-4 font-weight-light pl-8\">\n                    {{this.title}}\n                    </span>-->\n               \n              <!--  </v-card-title>-->\n            \n\n            <v-card-text class=\"py-0\"> \n            <div class=\"px-4\">\n            <v-row>\n            <v-col\n            class=col-12\n            >\n            <p class=\"caption grey--text text--darken-2 mb-0\">\n            <span class=\"font-weight-bold\">\n            Product Details\n<br />\n            </span>\n            {{description}}\n            </p>\n           \n            </v-col>\n            </v-row>  \n            </div>\n            </v-card-text>\n\n  <v-card-actions class=\"px-5 text--darken-1 teal--text\">\n       <v-badge color=\"green\" v-if=\"this.discounted\">\n      <template v-slot:badge>\n        <span \n        class=\"px-2\" \n        style=\"font-size:10px\"\n        >discount</span> <!-- <v-icon dark>mdi-check</v-icon> payWithPaystack -->\n      </template>\n      <span class=\"headline font-weight-light mb-0 teal--text\">{{newAmount | currency}}</span>\n    </v-badge>\n    <p v-else class=\"headline font-weight-light mb-0 teal--text pl-3\">\n       {{newAmount | currency}}\n        </p>\n             <v-btn\n             text\n             @click=\"sheet = true\"\n             color=\"#23d2aa\" \n             class=\"ml-10\"\n             :disabled=disabled :loading=\"loading\"\n             v-show=\"this.stock > 0\"\n             >\n              <v-icon small left>mdi-cash</v-icon>\n                pay now\n             </v-btn>\n             <v-chip outlined \n             color='red'\n             class=\"ml-10\"\n             v-show=\"this.stock == 0\"\n             >\n                  Sold Out\n              </v-chip>\n             <!--\n               <v-btn text color=\"grey\" \n               class=\"caption grey--text\"\n               :to=\"{\n                   name: 'merchant',\n                   params: {\n                       name: this.name\n                   }\n               }\"\n                >\n                  <v-icon small left>mdi-undo</v-icon>\n                  Back\n                </v-btn> \n                -->\n\n            </v-card-actions>\n\n <v-card-text class=\"\">\n     <div class=\"px-4\">\n                <v-row>\n                <v-col>\n                <v-text-field\n                class=\"teal--text form-field ma-0 pa-0\"\n                v-model=\"buyerName\"\n                label=\"Full Name\"\n                placeholder=\"Full Name\"\n                color=\"teal lighten-3\"\n                ></v-text-field>\n                </v-col>\n                <v-col>\n                <v-text-field\n                class=\"teal--text form-field ma-0 pa-0\"\n                label=\"Phone\"\n                v-model=\"buyerPhone\"\ntype=\"number\"\n                placeholder=\"Mobile\"\n                color=\"teal lighten-3\"\n                ></v-text-field>\n                </v-col>\n                </v-row>\n                <v-row>\n                <v-col>\n                <v-text-field\n                class=\"teal--text form-field ma-0 pa-0\"\n                v-model=\"buyerEmail\"\n                :rules=\"emailRules\"\n                label=\"Email\"\n                placeholder=\"Your Email\"\n                color=\"teal lighten-3\"\n                ></v-text-field>\n                </v-col>\n                </v-row>\n\n<v-row>\n                <v-col>\n                <v-text-field\n                class=\"teal--text form-field ma-0 pa-0 mb-5\"\n                v-model=\"buyerAddress\"\n                label=\"Delivery Address\"\n                placeholder=\"Your Location\"\n                hint=\"Enter your delivery address in full with closest landmark\"\n            persistent-hint\n                color=\"teal lighten-3\"\n                ></v-text-field>\n                </v-col>\n                </v-row>\n\n\n                <v-card\n    class=\"mx-auto\"\n    outlined\n  >\n  <v-card-title class=\"overline\">Add [+] options</v-card-title>\n<v-card-text>\n            <div class=\"form-group d-inline-block\" v-for=\"(option,k) in kOptions\" :key=\"k\">\n               <div v-if=\"checkOption != false\">\n                      <v-btn class=\"my-2 mr-2 lighten-1 white--text caption\" \n                      small \n                      :color=\"optionColor\" \n                    :loading=\"btnloading\"\n                      rounded\n                      :disabled=\"clicked.includes(k)\"\n                      @click=\"addOption(k,option.name,option.price)\"\n                      >\n                        <v-icon small>mdi-plus</v-icon>\n                        {{option.name}}\n                        <span class=\"ml-2 pa-2 white--text\" :class=\"priceOption\">\n₦ {{option.price}}\n                        </span>\n                      </v-btn>\n               </div>\n               <div v-else>no options</div>\n            </div>\n            </v-card-text>\n                </v-card>\n              \n\n    </div>\n         <!-- <p class=\"caption grey--text text--darken-2 font-weight-light mb-0\">\n            <span class=\"font-weight-bold\">\n            Delivery Details\n            </span> \n            </p>-->\n\n            </v-card-text>\n           \n            </v-form>\n           <Callback :paymentStatus=\"paymentStatus\" :dialog2=\"dialog\"></Callback>\n            </v-card>\n            <v-row justify=\"center\"> \n           <p class=\"caption text--grey my-5\" style=\"margin: 0 auto\">\npowered by <img :src=\"require('../assets/mulaalogo.png')\" alt=\"\" style=\"max-width:70px;margin-left:5px\">\n           </p>\n        \n       </v-row>\n\n       <v-bottom-sheet v-model=\"sheet\">\n      <v-sheet class=\"\" height=\"200px\">\n        <v-progress-linear\n          :value=\"50\"\n          class=\"my-0\"\n          height=\"3\"\n          color=\"teal\"\n        ></v-progress-linear>\n\n       <!-- <v-btn\n          class=\"mt-4\"\n          text\n          color=\"red\"\n          @click=\"sheet = !sheet\"\n        >close</v-btn>-->\n<v-list-item three-line>\n      <v-list-item-content>\n        <div class=\"overline mb-0\">Order Confirmation</div>\n        <v-list-item-title class=\"title mb-0 teal--text text--darken-4\"><span class=\"overline\">Total:</span><br> {{newAmount | currency}}</v-list-item-title>\n        <v-list-item-subtitle>{{this.title}}\n<div v-for=\"(option,i) in Options\" :key=\"i\" class=\"mt-1\">\n<v-chip\nsmall\nclass=\"my-0 d-inline green lighten-5 font-weight-light ml-n2\"\n>{{option.name}}\n  </v-chip>\n</div>\n        </v-list-item-subtitle>\n       <!-- <v-list-item-subtitle>\n          <v-btn\n             @click=\"payWithPaystack\"\n             color=\"#23d2aa\" \n             class=\"mt-3\"\n             :disabled=disabled :loading=\"loading\"\n             >\n              <v-icon small left>mdi-cash</v-icon>\n                Checkout\n             </v-btn>\n          </v-list-item-subtitle>-->\n      </v-list-item-content>\n\n      <v-list-item-avatar\n        tile\n        size=\"150\"\n        color=\"transparent\"\n      >\n      <!--<v-icon dark>mdi-cart</v-icon>-->\n      <v-btn\n             @click=\"payWithPaystack\"\n             color=\"green\" \n             class=\"mt-n3 white--text\"\n             tile\n             :disabled=disabled :loading=\"loading\"\n             >\n              <v-icon x-small left>mdi-cash</v-icon>\n                Checkout\n             </v-btn>\n      </v-list-item-avatar>\n    </v-list-item>\n\n      </v-sheet>\n    </v-bottom-sheet>\n    \n    <iframe :src=\"mySrc\" type=\"\" width=\"1%\" \n    height=\"1%\" frameborder=\"0\" style=\"display:none;z-index:-999\">\n  </iframe>\n\n    </div>\n</template>\n<script>\nimport { mapState, mapGetters } from 'vuex'\nimport axios from 'axios'\n//import Rave from 'vue-ravepayment';\n//import paystack from 'vue-paystack';\nimport Callback from '@/components/Callback'\nconst mulaa_key = 'pk_live_d2ea70959fc4383baf5844b947709e17db19b1d0'\nexport default {\n    props: ['name','theproducts'],\n     components: {\n        //paystack\n        Callback,\n        // Rave\n    },\n data(){\n        return {\n          //raveKey: \"FLWPUBK-xxxxxxxxxxxxxxxxxx-X\",\n          overlay:true,\n          checkOption: false,\n          optionColor: 'green',\n          priceOption: 'black',\n          loader: null,\n        btnloading: false,\n          clicked: [],\n            hide:false,\nprogress: 10,\ndialog: false,\npageurl: 'https://shop.mulaa.co'+this.$route.path,\n           infoBar: false,\n            /*title: this.theProduct.title,\n            hidethis: this.theProduct.hidden, \n            datePosted: this.theProduct.date_posted,\n            delivery:this.theProduct.delivery_locations,\n            description:this.theProduct.description,\n            discountPrice:this.theProduct.discount_price,\n            image: this.theProduct.image,\n            price: this.theProduct.price,\n            discounted: this.theProduct.show_discount,*/\n            sheet: false,\n            title:'',\n            title2: '',\n            delivery:'',\n            description:'',\n            discountPrice:'',\n            productOptions: '',\n            stock:'',\n            Options: [\n           \n            ],\n            image: '',\n            price: '',\n            discounted: '',\n            buyerName: '',\n            buyerEmail: '',\n            buyerPhone: '',\n            buyerAddress:'',\n            newAmount: null,\n            delivery:'',\n        infoMsg: '', \n        color: '',\n        paymentStatus: [],\n       emailRules: [\n        v => !!v || 'E-mail is required',\n        v => /.+@.+/.test(v) || 'E-mail must be valid'\n      ]\n        }\n    },\n\n    computed: {\n      ...mapState({\n      registerMsg:'registerMsg',\n      loading:'loading',\n      userKey:'userKey',\n      theProduct:'theProduct',\n      userDetails:'userDetails'\n      }),\n      loading: {\n      get() {\n        return this.$store.state.loading;\n      },\n      set(value) {\n        this.$store.commit('loading', value);\n      }\n    },\n    reference(){\n        let text = \"\";\n        let possible = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n \n        for( let i=0; i < 10; i++ )\n          text += possible.charAt(Math.floor(Math.random() * possible.length));\n \n        return text;\n      },\n      amount(){\n          if(this.discounted == false || this.discounted == undefined){\n              let amount = this.price\n              //console.log(this.discounted)\n             // console.log('amount: '+ amount)\n\n              return amount\n          }else {\n              //this.hide = true\n              console.log(this.discounted)\n              let amount = this.discountPrice\n              return amount\n          }\n      },\n       disabled() {\n       if (this.buyerName.length < 1 || this.buyerEmail == ' '){\n           this.infoBar = true\n           this.infoMsg = 'fill in your details to complete purchase'\n           this.color='red'\n         return true\n       }\n       return false\n        //return this.imageFile.length < 1; // or === 0   \n    },\n   kOptions: {\n      get: function(){\n        if(this.productOptions){\n          if(JSON.parse(this.productOptions).length > 1){\n            this.checkOption = true\n          }\n          //console.log(JSON.parse(this.productOptions).length)\n          \n          return JSON.parse(this.productOptions);\n        }\n        return  //this.productOptions//JSON.parse(this.productOptions);\n      }\n    },\n    mySrc: {\n    get: function() {\n      //concat using template literal\n      return `https://shop.mulaa.co/api/product/${this.title2}`\n    }\n  }\n\n    },\n     created() {\n        this.fetchData()\n        this.updateData()\n        this.toUrlString(this.title)\n       \n/*\n        const script = document.createElement('script')\n        script.src = 'https://api.ravepay.co/flwv3-pug/getpaidx/api/flwpbf-inline.js'\n        document.getElementsByTagName('head')[0].appendChild(script)\n        */\n\n//console.log(this.theProduct)\n    },\n    methods: {\n      addOption(index,name,price) {\n        console.log(name)\n        this.loader = 'btnloading'\n        //let nprice = parseInt(price)\n        this.newAmount = parseInt(this.newAmount) + parseInt(price)\n        this.price = parseInt(this.price) + parseInt(price)\nthis.clicked.push(index)\n            this.Options.push({ name: name, price: price });\n        },\n      toUrlString(productname){\nlet productName = productname\nproductName = productName.replace(/\\s+/g, '-').toLowerCase();\nthis.title2 = productName\n      },\n        salesRecord(response){\n            //console.log(\"sales: \"+response)\n\n//axios.post(`//dev.mulaa.africa/admin/wp-json/jwt-auth/v1/token`, {\n  axios.post(`https://shop.mulaa.co/api/wp-json/jwt-auth/v1/token`, {\n    username: 'system',\n    password: 'letmein2020()'\n  }\n).then(resp => {\n           //console.log(resp.data.token)\n           const options = {\n  headers: {'Authorization': 'Bearer '+resp.data.token}\n}\nconst salesData = {\n                title: this.title,\n                content: this.theProduct.title,\n                fields : {\n                 ref_id: response.reference,\n            amount: this.newAmount,\n            payment_mode: \"online\",\n            fullname: this.buyerName,\n            status: response.status,\n            message: response.message,\n            date: this.date,\n            product_id: this.$route.params.id,\n            product: this.title,\n            customer_email: this.buyerEmail,\n            customer_phone: this.buyerPhone,\n            location: this.buyerAddress,\n            transaction: response.transaction,\n            merchant: this.$route.params.name,\n            delivery: this.buyerAddress,\n            merchant_email: this.userDetails.email,\n            others: this.Options\n                },\n                 status: \"publish\"\n            }\n\n           //axios.post(`http://dev.mulaa.africa/admin/wp-json/wp/v2/sale`, \n           axios.post(`https://shop.mulaa.co/api/wp-json/wp/v2/sale`,\n           salesData, options\n).then(resp => {\n            //console.log(resp.data)\n            this.loading = false\n            })\n            //resolve(resp)\n          })\n          .catch(err => {\n              console.log(err)\n              \n          })\n        },\n        updateData(){\n          //console.log(this.theProduct.price)\n            if(this.theproducts === undefined){\n                //console.log('refreshed')\n                this.title = this.theProduct.title\n            this.hidethis = this.theProduct.hidden\n            this.datePosted = this.theProduct.date_posted\n            this.delivery = this.theProduct.delivery_locations\n            this.description = this.theProduct.description\n            this.discountPrice = this.theProduct.discount_price\n            this.image = this.theProduct.image\n            this.price = this.theProduct.price\n            this.discounted = this.theProduct.show_discount\n            this.newAmount = this.amount\n            this.stock = this.theProduct.stock\n            this.productOptions = this.theProduct.product_options\n            console.log(this.theProduct.productOptions)\n             //console.log('refreshed amount '+this.newAmount) \n            }else{\n                //console.log('valid click')\n                //console.log(this.theproducts)\n                this.title = this.theproducts.title\n            this.hidethis = this.theproducts.hidden\n            this.datePosted = this.theproducts.date_posted\n            this.delivery = this.theproducts.delivery_locations\n            this.description = this.theproducts.description//this.theProduct.description\n            this.discountPrice = this.theproducts.discount_price\n            this.image = this.theproducts.image\n            this.price = this.theproducts.price\n            this.discounted = this.theproducts.show_discount\n            this.productOptions = this.theproducts.productOptions\n            this.newAmount = this.amount\n            this.stock = this.theproducts.stock\n            //console.log(this.newAmount)\n            }\n        },\n        amount2(){\n          if(this.discounted == true){\n              let amount = this.discountPrice * 100\n              \n              console.log('discount price: '+ amount)\n              return amount\n          }else {\n              let amount = this.price * 100\n              console.log('full price: '+this.price)\n              return amount\n          }\n      },\n      resetForm () {\n        this.$refs.buyForm.reset()\n      },\n    reset(file, name) {\n      console.log(\"File --> \", file);\n      console.log(\"FileName -->\", name);\n    },\n    fileChange(file, name) {\n      console.log(\"File --> \", file);\n      console.log(\"FileName -->\", name);\n    },\n    onErr(err, file) {\n      console.log(\"​onErr -> file\", file);\n      console.log(\"​onErr -> err\", err);\n    },\n     onSuc(res, file) {\n      console.log(\"​onSuc -> file\", file);\n      console.log(\"​onSuc -> res\", res);\n      this.imgUrl = res.url\n      this.uploadMsg = res.message\n      \n    },\n    exceedHandler(file) {\n      console.warn(\"onExceed -> file\", file);\n    },\n    fetchData(){\n        this.$store.dispatch('loadProduct', this.$route.params.id)\n        this.$store.dispatch('loadUserDetails', this.name)\n        //console.log(\"product id: \"+this.$route.params.id)\n    },\n  callback: function(response){\n       // console.log(response)\n       \n       this.paymentStatus = response\n       this.salesRecord(response)\n            var oLuanchBtn = document.getElementById('popupBtn');\n            oLuanchBtn.style.visibility = 'hidden';\n            oLuanchBtn.click();\n            //this.resetForm()\n            \n            console.log('payment: '+this.paymentStatus.reference)\n      },\n      close: function(){\n          console.log(\"Payment closed\")\n      },\n      payWithPaystack() {\n        if(this.userDetails.subaccount_code !='' || this.userDetails.subaccount_code !=null)\n        {\n          //console.log('use subaccount '+ mulaa_key)\n          //\n          const paystackOptions = {\n                    key: mulaa_key,\n                    email: this.buyerEmail,\n                    amount: Number(this.amount2()),\n                    subaccount: this.userDetails.subaccount_code,\n                    transaction_charge: 0,\n                    bearer: 'subaccount',\n                    ref: this.reference,\n                    callback: (response) => { //message: \"Approved\" reference: \"rVZKHQSn6b\" status: \"success\" trans: \"256223954\" transaction: \"256223954\" trxref: \"rVZKHQSn6b\"\n                        this.callback(response)\n                        //this.showPopup(response)\n                    },\n                    onClose: () => {\n                        this.close()\n                        this.$router.go(-1)\n                    }\n                }\n            //console.log(paystackOptions)\n          const handler = window.PaystackPop.setup(paystackOptions)\n          handler.openIframe()\n          //\n        }else{\n const paystackOptions = {\n                    key: this.userDetails.payment_key,\n                    email: this.buyerEmail,\n                    amount: Number(this.amount2()),\n                    ref: this.reference,\n                    callback: (response) => { //message: \"Approved\" reference: \"rVZKHQSn6b\" status: \"success\" trans: \"256223954\" transaction: \"256223954\" trxref: \"rVZKHQSn6b\"\n                        this.callback(response)\n                        //this.showPopup(response)\n                    },\n                    onClose: () => {\n                        this.close()\n                        this.$router.go(-1)\n                    }\n                }\n            //console.log(paystackOptions)\n          const handler = window.PaystackPop.setup(paystackOptions)\n          handler.openIframe()\n        }\n         \n      }\n  },\n  mounted() {\n     //console.log(this.userDetails.subaccount_code)\nthis.loading = false\n    let paystackScript = document.createElement('script')\n    paystackScript.setAttribute('src', 'https://js.paystack.co/v1/inline.js')\n    document.head.appendChild(paystackScript)\n\n//let phpUrl = document.createElement('iframe')\n//phpUrl.setAttribute('src', 'https://shop.mulaa.co/api/product/the-uju-set')\n//document.body.appendChild(phpUrl)\n\n    var oLuanchBtn = document.getElementById('popupBtn');\n            oLuanchBtn.style.display = 'none';\n         // this.showPopup()   \n          //console.log('userdetails: '+JSON.stringify(this.userDetails))  \n  },\n  watch: {\n      loader () {\n        const l = this.loader\n        this[l] = !this[l]\n\n        setTimeout(() => (this[l] = false), 3000)\n\n        this.loader = null\n      },\n    }\n}\n</script>\n<style>\n    .hide{\n        display:none!important;\n    }\n    .otto {\n text-shadow: 0px 1px 1px rgba(0,0,0, 0.4); \n}\n</style>"]}]}